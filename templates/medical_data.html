{% extends 'base.html' %}

{% block title %}Medical Profile{% endblock %}

{% block header %}Medical Data for {{ pet.name }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">Medical Overview</h3>
    <a href="{{ url_for('pets.edit_medical_data', pet_id=pet.id) }}" class="btn btn-outline-secondary">‚úèÔ∏è Edit Medical Data</a>
  </div>

  {% if medical_profile %}
    <div class="card mb-3">
      <div class="card-body">
        <p><strong>Blood Type:</strong> {{ medical_profile.blood_type or '‚Äî' }}</p>
        <p><strong>Weight:</strong> {{ medical_profile.weight or '‚Äî' }}</p>
        <p><strong>Last Weighed:</strong> {{ medical_profile.weight_updated or '‚Äî' }}</p>
        <p><strong>Chronic Conditions:</strong><br> {{ medical_profile.chronic_conditions or '‚Äî' }}</p>
        <p><strong>Notes:</strong><br> {{ medical_profile.notes or '‚Äî' }}</p>
      </div>
    </div>
  {% else %}
    <p class="text-muted">No medical data available yet for {{ pet.name }}.</p>
    <a href="{{ url_for('pets.edit_medical_data', pet_id=pet.id) }}" class="btn btn-primary">Add Medical Data</a>
  {% endif %}
<a href="{{ url_for('pets.pet_profile', pet_id=pet.id) }}" class="btn btn-outline-primary">Back to Pet Profile</a>

</div>

<div class="container mt-4">
<h5 class="mt-4">üß¨ Vaccination Records</h5>
{% if medical_profile.vaccination_records %}
  {% for record in medical_profile.vaccination_records %}
    <div class="card mb-2">
      <div class="card-body">
        <p><strong>Vaccine:</strong> {{ record.vaccine_name or '‚Äî' }}</p>
        <p><strong>Dose #:</strong> {{ record.dose_number or '‚Äî' }}</p>
        <p><strong>Batch:</strong> {{ record.batch_number or '‚Äî' }}</p>
        <p><strong>Previous:</strong> {{ record.previous_vaccination_date or '‚Äî' }}</p>
        <p><strong>Next:</strong> {{ record.next_vaccination_date or '‚Äî' }}</p>
        <p><strong>Notes:</strong> {{ record.additional_info or '‚Äî' }}</p>
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-warning" role="alert">
    <em>No vaccination records found</em>
  </div>
{% endif %}
</div>

<div class="container mt-4">
<h5 class="mt-4">üíä Medications</h5>
{% if medical_profile.medications %}
  {% for med in medical_profile.medications %}
    <div class="card mb-2">
      <div class="card-body">
        <p><strong>Name:</strong> {{ med.name or '‚Äî' }}</p>
        <p><strong>Dosage:</strong> {{ med.dosage or '‚Äî' }}</p>
        <p><strong>Duration:</strong> {{ med.duration or '‚Äî' }}</p>
        <p><strong>Notes:</strong> {{ med.additional_info or '‚Äî' }}</p>
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-warning" role="alert">
    <em>No medication records found</em>
  </div>
{% endif %}
</div>

<div class="container mt-4">
<h5 class="mt-4">üß™ Test Results</h5>
{% if medical_profile.test_results %}
  {% for test in test_results %}
    <div class="card mb-2">
      <div class="card-body">
        <p><strong>Type:</strong> {{ test.test_type or '‚Äî' }}</p>
        <p><strong>Result:</strong> {{ test.result or '‚Äî' }}</p>
        <p><strong>Date:</strong> {{ test.date or '‚Äî' }}</p>
        <p><strong>Notes:</strong> {{ test.additional_info or '‚Äî' }}</p>
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-warning" role="alert">
    <em>No test results found.</em>
  </div>
{% endif %}
</div>

<div class="container mt-4">
<h5 class="mt-4">ü©∫ Vet Visits</h5>
{% if medical_profile.vet_visits %}
  {% for visit in medical_profile.vet_visits %}
    <div class="card mb-2">
      <div class="card-body">
        <p><strong>Reason:</strong> {{ visit.reason or '‚Äî' }}</p>
        <p><strong>Vet Name:</strong> {{ visit.vet_name or '‚Äî' }}</p>
        <p><strong>Clinic Info:</strong> {{ visit.clinic_info or '‚Äî' }}</p>
        <p><strong>Date:</strong> {{ visit.date or '‚Äî' }}</p>

      {% if visit.documents %}
      <p>
        <strong>Document:</strong>
        <a href="{{ url_for('pets.serve_uploaded_file', filename=visit.documents) }}" target="_blank">
          {{ visit.documents }}
        </a>
      </p>
    {% else %}
      <p><strong>Document:</strong> <em>‚Äî</em></p>
    {% endif %}

      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-warning" role="alert">
    <em>No vet visits recorded yet.</em>
  </div>
{% endif %}
</div>

<div class="container mt-4">
<h5 class="mt-4">üìé Medical Documents</h5>
{% if medical_profile.medical_documents %}
  {% for doc in medical_profile.medical_documents %}
    <div class="card mb-2">
      <div class="card-body">
        {% if doc.file_path %}
          <p>
            <strong>File:</strong>
            <a href="{{ url_for('pets.serve_uploaded_file', filename=doc.file_path) }}" target="_blank">
              {{ doc.file_path }}
            </a>
          </p>
        {% else %}
          <p><strong>File:</strong> <em>‚Äî</em></p>
        {% endif %}

        <p><strong>Description:</strong> {{ doc.description or '‚Äî' }}</p>
        <p><strong>Uploaded:</strong> {{ doc.uploaded_at or '‚Äî' }}</p>
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-warning" role="alert">
    <em>No medical documents uploaded yet.</em>
  </div>
{% endif %}
</div>


{% endblock %}
